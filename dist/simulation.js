!function(t,s){"object"==typeof exports&&"object"==typeof module?module.exports=s():"function"==typeof define&&define.amd?define([],s):"object"==typeof exports?exports.Simulation=s():t.Simulation=s()}(self,(function(){return(()=>{var t={877:(t,s,i)=>{var e=i(570),o=i(171),h=o;h.v1=e,h.v4=o,t.exports=h},327:t=>{for(var s=[],i=0;i<256;++i)s[i]=(i+256).toString(16).substr(1);t.exports=function(t,i){var e=i||0,o=s;return[o[t[e++]],o[t[e++]],o[t[e++]],o[t[e++]],"-",o[t[e++]],o[t[e++]],"-",o[t[e++]],o[t[e++]],"-",o[t[e++]],o[t[e++]],"-",o[t[e++]],o[t[e++]],o[t[e++]],o[t[e++]],o[t[e++]],o[t[e++]]].join("")}},217:t=>{var s="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(s){var i=new Uint8Array(16);t.exports=function(){return s(i),i}}else{var e=new Array(16);t.exports=function(){for(var t,s=0;s<16;s++)0==(3&s)&&(t=4294967296*Math.random()),e[s]=t>>>((3&s)<<3)&255;return e}}},570:(t,s,i)=>{var e,o,h=i(217),a=i(327),r=0,n=0;t.exports=function(t,s,i){var c=s&&i||0,d=s||[],l=(t=t||{}).node||e,u=void 0!==t.clockseq?t.clockseq:o;if(null==l||null==u){var y=h();null==l&&(l=e=[1|y[0],y[1],y[2],y[3],y[4],y[5]]),null==u&&(u=o=16383&(y[6]<<8|y[7]))}var x=void 0!==t.msecs?t.msecs:(new Date).getTime(),v=void 0!==t.nsecs?t.nsecs:n+1,m=x-r+(v-n)/1e4;if(m<0&&void 0===t.clockseq&&(u=u+1&16383),(m<0||x>r)&&void 0===t.nsecs&&(v=0),v>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");r=x,n=v,o=u;var p=(1e4*(268435455&(x+=122192928e5))+v)%4294967296;d[c++]=p>>>24&255,d[c++]=p>>>16&255,d[c++]=p>>>8&255,d[c++]=255&p;var f=x/4294967296*1e4&268435455;d[c++]=f>>>8&255,d[c++]=255&f,d[c++]=f>>>24&15|16,d[c++]=f>>>16&255,d[c++]=u>>>8|128,d[c++]=255&u;for(var g=0;g<6;++g)d[c+g]=l[g];return s||a(d)}},171:(t,s,i)=>{var e=i(217),o=i(327);t.exports=function(t,s,i){var h=s&&i||0;"string"==typeof t&&(s="binary"===t?new Array(16):null,t=null);var a=(t=t||{}).random||(t.rng||e)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,s)for(var r=0;r<16;++r)s[h+r]=a[r];return s||o(a)}},603:(t,s,i)=>{const e=i(555);t.exports=class{constructor(t,s=[]){this.simulation=t,this.x=s.x??-100,this.y=s.y??-100,this.click=!1,this.aimed=void 0,this.enabled=!1}enable(){this.enabled=!0,this.simulation.canvas.addEventListener("mousemove",(t=>this.place(t))),this.simulation.canvas.addEventListener("mouseleave",(()=>this.mouseUp())),this.simulation.canvas.addEventListener("mousedown",(()=>this.mouseDown())),this.simulation.canvas.addEventListener("mouseup",(()=>this.mouseUp())),this.simulation.canvas.addEventListener("touchstart",(()=>this.mouseDown()),!1),this.simulation.canvas.addEventListener("touchend",(()=>this.mouseUp()),!1),this.simulation.canvas.addEventListener("touchcancel",(()=>this.handleCancel()),!1),this.simulation.canvas.addEventListener("touchleave",(()=>this.mouseUp),!1),this.simulation.canvas.addEventListener("touchmove",(t=>this.place(t)),!1)}handleCancel(){this.click=!1,this.aimed=void 0,this.x=-100,this.y=-100}mouseDown(){this.click=!0}mouseUp(){this.click=!1,this.aimed&&this.aimed.cursorCallback&&this.aimed.cursorCallback(this),this.aimed=void 0,this.x=-100,this.y=-100}get module(){return Math.sqrt(this.x**2+this.y**2)}get coords(){return{x:this.x,y:this.y}}place(t){t.preventDefault();var s;s=t.changedTouches?{x:t.changedTouches[0].pageX,y:t.changedTouches[0].pageY}:{x:t.pageX,y:t.pageY},console.log(s),this.x=s.x-this.simulation.rect.x,this.y=s.y-this.simulation.rect.y}draw(){e.drawCircle(this.simulation.context,this.coords,5),this.aimed&&e.drawVect(this.simulation.context,this.coords,this.aimed.coords,{color:"white",width:3})}aim(t){this.aimed=t}}},138:(t,s,i)=>{t.exports=i(446).default},417:t=>{t.exports=class{constructor(t={}){this._defaultParams={x:0,y:0,vx:0,vy:0,ax:0,ay:0,friction:()=>1},this._types={position:"",speed:"v",acceleration:"a"},Object.entries(this._defaultParams).forEach((([s,i])=>{this[s]=t[s]??i})),Object.entries(this._types).forEach((([t,s])=>{this[t]=function(t={}){return void 0!==t.x&&(this[s+"x"]=t.x),void 0!==t.y&&(this[s+"y"]=t.y),{x:this[s+"x"],y:this[s+"y"]}}}))}update(){this.vx=this.ax+this.friction()*this.vx,this.vy=this.ay+this.friction()*this.vy,this.x+=this.vx,this.y+=this.vy}get speedValue(){return Math.sqrt(this.vx**2+this.vy**2)}get getSpeed(){return{x:this.vx,y:this.vy}}get nextPosition(){return{x:this.x+this.vx,y:this.y+this.vy}}get nextSpeed(){return{x:this.vx+this.ax,y:this.vy+this.ay}}}},827:(t,s,i)=>{const e=i(417),o=i(555),{v4:h}=i(877);t.exports=class{constructor(t,s={}){this.simulation=t,this.ctx=this.simulation.context,this.uuid=h(),this.mass=s.mass??10,this.density=s.density??1,this.color=s.color??"black",this.style=s.style??"fill",this.draggable=s.draggable??!1,this.h=this.w=this.mass*this.density,this.coords=new e({vx:0,vy:0,...s.coords})}get v(){return Math.sqrt(this.vx**2+this.vy**2)}get a(){return Math.sqrt(this.ax**2+this.ay**2)}get Ec(){return.5*this.mass*this.v**2}get hover(){return o.distance(this.simulation.cursor.coords,this.coords)<=this.h}get grab(){return this.hover&&this.simulation.cursor.click}update(){this.draw(),this.draggable&&this.grab&&this.simulation.cursor.aim(this),this.checkWallCollision(),this.checkParticleCollision(),this.coords.update()}cursorCallback(t){console.log(this),this.coords.vx=.2*(this.coords.x-t.coords.x),this.coords.vy=.2*(this.coords.y-t.coords.y)}draw(){this.ctx[this.style+"Style"]=this.color,this.ctx.beginPath(),this.ctx.arc(this.coords.x,this.coords.y,this.h*(this.hover&&this.draggable?1.2:1),0,2*Math.PI),this.ctx[this.style](),this.ctx.closePath()}checkParticleCollision(){for(let t=0;t<this.simulation.particlesUUIDs.length;t++){let{mass:s,uuid:i,h:e,w:h,coords:a}=this.simulation.particles[this.simulation.particlesUUIDs[t]];if(this.uuid===i)continue;this.simulation.showLines&&o.drawVect(this.ctx,this.coords,a,{color:"gray"}),this.simulation.showDirections&&o.drawVect(this.ctx,this.coords,{x:this.coords.x+30*this.coords.vx,y:this.coords.y+30*this.coords.vy},{color:"black",width:2});let r=this.coords.x-a.x,n=this.coords.y-a.y,c=Math.abs(Math.sqrt(r**2+n**2));const d=this.coords.vx-a.vx,l=this.coords.vy-a.vy,u=a.x-this.coords.x,y=a.y-this.coords.y;if(c<=this.w+h&&d*u+l*y>=0){const t=-Math.atan2(a.y-this.coords.y,a.x-this.coords.x),i=this.mass,e=s,h=o.rotate(this.coords.getSpeed,t),r=o.rotate(a.getSpeed,t),n={x:h.x*(i-e)/(i+e)+2*r.x*e/(i+e),y:h.y},c={x:r.x*(i-e)/(i+e)+2*h.x*e/(i+e),y:r.y},d=o.rotate(n,-t),l=o.rotate(c,-t);this.coords.speed({x:d.x,y:d.y}),a.speed({x:l.x,y:l.y})}}}checkWallCollision(){Math.ceil(this.coords.y+this.h)>this.simulation.h&&this.coords.speed({x:this.coords.vx,y:-Math.abs(this.coords.vy)}),Math.floor(this.coords.y-this.h)<0&&this.coords.speed({x:this.coords.vx,y:Math.abs(this.coords.vy)}),Math.ceil(this.coords.x+this.w)>this.simulation.w&&this.coords.speed({x:-Math.abs(this.coords.vx),y:this.coords.vy}),Math.floor(this.coords.x-this.w)<0&&this.coords.speed({x:Math.abs(this.coords.vx),y:this.coords.vy})}}},446:(t,s,i)=>{"use strict";i.d(s,{default:()=>r});const e=i(827),o=i(603),h=i(555),{v4:a}=i(877);class r{constructor(t={}){this.showDirections=t.showDirections??!1,this.showLines=t.showLines??!1,this.h=t.height??300,this.w=t.width??400,this.ratio=this.w/this.h,this.toSummon=t.toSummon??10,this.fps=t.fps??20,this.particles={},this.particleOpts=t.particleOpts??{mass:5},this.parent=t.parent??document.body,this.bg=t.background??"#fefefe",this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.canvas.classList.add("simulation"),this.canvas.dataset.uuid=a(),this.canvas.style.background=this.bg,this.parent.appendChild(this.canvas),this.playing=t.autoPlay??!0,this.t=0,this.rect=this.canvas.getBoundingClientRect(),this.cursor=new o(this),this.w>document.body.offsetWidth&&(this.w=.9*this.canvas.parentElement.offsetWidth,this.h=this.w/this.ratio)}get particlesUUIDs(){return Object.keys(this.particles)}setFPS(t){this.fps=t}size(t=this.h,s=this.w){this.h=t,this.w=s,this.init()}anim(){this.context.clearRect(0,0,this.w,this.h);for(let t=0;t<this.particlesUUIDs.length;t++)this.particles[this.particlesUUIDs[t]].update(this.t);this.playing&&(this.animFrame=requestAnimationFrame((()=>this.anim())),this.cursor.draw())}init(){cancelAnimationFrame(this.animFrame),this.canvas.height=this.h,this.canvas.width=this.w,this.particles={};for(let t=0;t<this.toSummon;t++)this.addParticle();this.anim()}addParticles(t){for(let s=0;s<t.length;s++)this.addParticle(t[s])}addParticle(t={}){let s=new e(this,{...this.particleOpts,...t});t.coords||(s.coords.position({x:h.randomInt(s.h,this.w-s.h),y:h.randomInt(s.h,this.h-s.h)}),s.coords.speed({x:h.randomInt(-2,2),y:h.randomInt(-2,2)})),this.particles[s.uuid]=s}removeParticle(t){this.particles[t]&&delete this.particles[t]}pause(){this.playing=!1}play(){this.playing||(this.playing=!0,this.anim())}}},555:t=>{t.exports={randomInt:function(t,s){return t=Math.ceil(t),s=Math.floor(s),Math.floor(Math.random()*(s-t+1))+t},randomFloat:function(t,s){return Math.random()*(s-t)+t},drawVect:function(t,s,i,e={}){t.strokeStyle=e.color??"yellow",t.lineWidth=e.width??.1,t.beginPath(),t.moveTo(s.x,s.y),t.lineTo(i.x,i.y),t.stroke(),t.closePath()},drawCircle:function(t,s,i,e={}){t[(e.style??"fill")+"Style"]=e.color??"black",t.beginPath(),t.arc(s.x,s.y,i,0,2*Math.PI),t[e.style??"fill"](),t.closePath()},drawText:function(t,s,i,e={}){t.fillStyle="black",t.font=`${e.size??"48px"} ${e.font??"serif"}`,t.fillText(i,s.x,s.y)},distance:function(t,s){let i=t.x-s.x,e=t.y-s.y;return Math.abs(Math.sqrt(i**2+e**2))},rotate:function(t,s){return{x:t.x*Math.cos(s)-t.y*Math.sin(s),y:t.x*Math.sin(s)+t.y*Math.cos(s)}}}}},s={};function i(e){var o=s[e];if(void 0!==o)return o.exports;var h=s[e]={exports:{}};return t[e](h,h.exports,i),h.exports}return i.d=(t,s)=>{for(var e in s)i.o(s,e)&&!i.o(t,e)&&Object.defineProperty(t,e,{enumerable:!0,get:s[e]})},i.o=(t,s)=>Object.prototype.hasOwnProperty.call(t,s),i(138)})()}));